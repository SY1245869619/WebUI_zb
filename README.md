# WebUIè‡ªåŠ¨åŒ–æµ‹è¯•é¡¹ç›®

åŸºäº Playwright + pytest + NiceGUI çš„WebUIè‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œä¸“ä¸º"Webæ¡Œé¢"å¼å‰ç«¯åº”ç”¨è®¾è®¡ã€‚

## ğŸ“‹ é¡¹ç›®ç‰¹æ€§

âœ… **æ¨¡å—åŒ–åº”ç”¨ç®¡ç†** - æ¯ä¸ªåº”ç”¨ï¼ˆæˆè¯¾æ•™å­¦ã€æ”»é˜²æ¼”ç»ƒã€è€ƒè¯•æµ‹è¯„ç­‰ï¼‰ä½œä¸ºç‹¬ç«‹æ¨¡å—  
âœ… **è‡ªå®šä¹‰è¿è¡Œ** - æ”¯æŒé€šè¿‡Webç•Œé¢é€‰æ‹©è¦æ‰§è¡Œçš„åº”ç”¨æ¨¡å—  
âœ… **MySQLæ”¯æŒ** - é›†æˆPyMySQLï¼Œæ”¯æŒæ•°æ®åº“æ“ä½œå’Œæ•°æ®éªŒè¯  
âœ… **é’‰é’‰æœºå™¨äººé€šçŸ¥** - æ”¯æŒæµ‹è¯•æ‰§è¡Œç»“æœè‡ªåŠ¨å‘é€åˆ°é’‰é’‰ç¾¤  
âœ… **é‚®ä»¶é€šçŸ¥** - æ”¯æŒæµ‹è¯•æŠ¥å‘Šé‚®ä»¶å‘é€  
âœ… **å¤±è´¥å¤„ç†æœºåˆ¶** - æ”¯æŒæ­¥éª¤è·³è¿‡å’ŒçŠ¶æ€é‡ç½®  
âœ… **Webæ§åˆ¶ç•Œé¢** - ç¾è§‚çš„NiceGUIç•Œé¢ï¼Œå¯è§†åŒ–é…ç½®å’Œæ‰§è¡Œ  
âœ… **ç”¨ä¾‹å½•åˆ¶** - é›†æˆPlaywright Codegenï¼Œæ”¯æŒå¯è§†åŒ–å½•åˆ¶ç”¨ä¾‹  
âœ… **Excelç”¨ä¾‹å¯¼å…¥** - æ”¯æŒä»Excelè¡¨æ ¼å¯¼å…¥æµ‹è¯•ç”¨ä¾‹ï¼ŒéæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½ç¼–å†™ç”¨ä¾‹  
âœ… **Page Objectæ¨¡å¼** - æ¸…æ™°çš„é¡µé¢å¯¹è±¡å°è£…ï¼Œæ˜“äºç»´æŠ¤  
âœ… **å¤±è´¥é‡è¯•æœºåˆ¶** - æ”¯æŒé…ç½®é‡è¯•æ¬¡æ•°å’Œé‡è¯•å»¶è¿Ÿï¼Œæé«˜æµ‹è¯•ç¨³å®šæ€§  
âœ… **è¶…æ—¶é…ç½®** - æ”¯æŒè‡ªå®šä¹‰æµ‹è¯•ç”¨ä¾‹è¶…æ—¶æ—¶é—´ï¼Œçµæ´»æ§åˆ¶æ‰§è¡Œæ—¶é•¿  
âœ… **è‡ªå®šä¹‰ä¸­æ–‡æŠ¥å‘Š** - ç”Ÿæˆç¾è§‚çš„ä¸­æ–‡æµ‹è¯•æŠ¥å‘Šï¼ŒåŒ…å«å›¾è¡¨åˆ†æå’Œè¶‹åŠ¿å±•ç¤º  
âœ… **æˆªå›¾ç®¡ç†** - è‡ªåŠ¨æˆªå›¾ï¼ˆé”™è¯¯ã€æˆåŠŸã€å…³é”®æ­¥éª¤ï¼‰ï¼Œæ”¯æŒæ‰‹åŠ¨æˆªå›¾ï¼Œæˆªå›¾ç±»å‹æ¸…æ™°æ ‡è¯†  

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
WebUI_zb/
â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ settings.yaml         # å…¨å±€é…ç½®ï¼ˆæ•°æ®åº“ã€é€šçŸ¥ã€Playwrightï¼‰
â”‚   â””â”€â”€ module_config.yaml    # åº”ç”¨æ¨¡å—é…ç½®
â”œâ”€â”€ core/                     # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ web_ui_driver.py     # Playwrightæµè§ˆå™¨é©±åŠ¨å°è£…
â”‚   â”œâ”€â”€ notification.py      # é’‰é’‰ã€é‚®ä»¶é€šçŸ¥æœåŠ¡
â”‚   â””â”€â”€ db_client.py         # MySQLæ•°æ®åº“å®¢æˆ·ç«¯
â”œâ”€â”€ pages/                    # Page Object é¡µé¢å¯¹è±¡
â”‚   â”œâ”€â”€ base_page.py         # é¡µé¢åŸºç±»
â”‚   â”œâ”€â”€ desktop_page.py      # æ¡Œé¢é¡µé¢ï¼ˆå›¾æ ‡ç‚¹å‡»ç­‰ï¼‰
â”‚   â””â”€â”€ login_page.py        # ç™»å½•é¡µé¢
â”œâ”€â”€ test_cases/              # æµ‹è¯•ç”¨ä¾‹ï¼ˆæŒ‰åº”ç”¨æ¨¡å—ç»„ç»‡ï¼‰
â”‚   â”œâ”€â”€ teaching/           # æˆè¯¾æ•™å­¦æ¨¡å—ç”¨ä¾‹
â”‚   â”œâ”€â”€ exercise/           # æ”»é˜²æ¼”ç»ƒæ¨¡å—ç”¨ä¾‹
â”‚   â”œâ”€â”€ exam/               # è€ƒè¯•æµ‹è¯„æ¨¡å—ç”¨ä¾‹
â”‚   â””â”€â”€ conftest.py         # pytestå…±äº«å¤¹å…·
â”œâ”€â”€ web_ui/                  # Webæ§åˆ¶ç•Œé¢
â”‚   â”œâ”€â”€ main.py            # NiceGUIåº”ç”¨ä¸»å…¥å£
â”‚   â””â”€â”€ components/        # ç•Œé¢ç»„ä»¶
â”‚       â”œâ”€â”€ module_selector.py      # æ¨¡å—é€‰æ‹©å™¨
â”‚       â””â”€â”€ notification_config.py # é€šçŸ¥é…ç½®ç»„ä»¶
â”œâ”€â”€ utils/                   # å·¥å…·ç±»
â”‚   â”œâ”€â”€ recording_auto_login.py  # å½•åˆ¶å·¥å…·è‡ªåŠ¨ç™»å½•
â”‚   â”œâ”€â”€ report_parser.py          # æµ‹è¯•æŠ¥å‘Šè§£æå™¨
â”‚   â”œâ”€â”€ custom_report_generator.py  # è‡ªå®šä¹‰ä¸­æ–‡æŠ¥å‘Šç”Ÿæˆå™¨
â”‚   â””â”€â”€ screenshot_utils.py      # æˆªå›¾å·¥å…·
â”œâ”€â”€ logs/                    # æ—¥å¿—ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–
â”œâ”€â”€ pytest.ini              # pytesté…ç½®
â””â”€â”€ run.py                  # é¡¹ç›®å¯åŠ¨å…¥å£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.8+
- MySQL 5.7+ï¼ˆå¯é€‰ï¼Œå¦‚æœä½¿ç”¨æ•°æ®åº“åŠŸèƒ½ï¼‰

### 2. å®‰è£…ä¾èµ–

```bash
# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# å®‰è£…Playwrightæµè§ˆå™¨
playwright install
```

### 3. é…ç½®é¡¹ç›®

#### 3.1 pytest-htmlç¼–ç è¡¥ä¸ï¼ˆWindowsç³»ç»Ÿï¼‰

**é‡è¦**ï¼šåœ¨Windowsç³»ç»Ÿä¸‹ï¼Œpytest-htmlç”Ÿæˆçš„HTMLæŠ¥å‘Šå¯èƒ½ä¼šå‡ºç°ä¸­æ–‡ä¹±ç ã€‚é¡¹ç›®å·²åŒ…å«è‡ªåŠ¨è¡¥ä¸åŠŸèƒ½ï¼Œä¼šåœ¨é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨ä¿®å¤ã€‚

å¦‚æœè‡ªåŠ¨è¡¥ä¸å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ï¼š
1. æ‰¾åˆ°pytest-htmlå®‰è£…ç›®å½•ï¼š`C:\Python310\lib\site-packages\pytest_html\html_report.py`
2. æ‰¾åˆ°ç¬¬117è¡Œå·¦å³çš„ `html.meta(charset="utf-8")`
3. æ”¹ä¸ºï¼š`html.meta(charset="GB2312")`

æˆ–è€…è¿è¡Œè¡¥ä¸è„šæœ¬ï¼š
```bash
python -c "import utils.pytest_html_patch; utils.pytest_html_patch.patch_pytest_html_charset()"
```

#### 3.2 ç¼–è¾‘é…ç½®æ–‡ä»¶

ç¼–è¾‘ `config/settings.yaml` é…ç½®æ–‡ä»¶ï¼š

```yaml
# æ•°æ®åº“é…ç½®ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
database:
  host: localhost
  port: 3306
  user: root
  password: your_password
  database: test_db
  charset: utf8mb4

# é€šçŸ¥é…ç½®
notification:
  dingtalk:
    enabled: false  # è®¾ç½®ä¸ºtrueå¯ç”¨é’‰é’‰é€šçŸ¥
    webhook: https://oapi.dingtalk.com/robot/send?access_token=your_token
    secret: your_secret  # å¯é€‰
  
  email:
    enabled: false  # è®¾ç½®ä¸ºtrueå¯ç”¨é‚®ä»¶é€šçŸ¥
    smtp_server: smtp.qq.com
    smtp_port: 587
    sender_email: your_email@qq.com
    sender_password: your_password
    receiver_emails:
      - receiver@example.com

# Playwrighté…ç½®
playwright:
  headless: false
  slow_mo: 100
  timeout: 30000
  browser: chromium
  viewport:
    width: 1920
    height: 1080
```

ç¼–è¾‘ `config/module_config.yaml` é…ç½®æ¡Œé¢ç›¸å…³è®¾ç½®ï¼š

```yaml
desktop:
  icon_selector: .desktop-icon  # æ¡Œé¢å›¾æ ‡é€‰æ‹©å™¨
  wait_timeout: 7000  # ç­‰å¾…æ¡Œé¢åŠ è½½è¶…æ—¶æ—¶é—´
```

**æ³¨æ„**ï¼šæ¡Œé¢URLä¼šä»ç™»å½•é…ç½®è‡ªåŠ¨è·å–ï¼Œæ— éœ€åœ¨æ­¤é…ç½®ã€‚ç™»å½•åä¼šè‡ªåŠ¨è·³è½¬åˆ°æ¡Œé¢ã€‚

**é‡è¦**ï¼šç™»å½•é…ç½®å·²åœ¨ `config/settings.yaml` ä¸­é¢„è®¾ï¼š
- ç™»å½•URL: `http://10.70.70.96/Shenyuan_9#/login`
- ç”¨æˆ·å: `Shenyuan_9`
- å¯†ç : `Shenyuan_9`

ä½ ä¹Ÿå¯ä»¥é€šè¿‡Webæ§åˆ¶ç•Œé¢çš„"ç™»å½•é…ç½®"é¢æ¿ä¿®æ”¹è¿™äº›ä¿¡æ¯ã€‚

### 4. å¯åŠ¨Webæ§åˆ¶ç•Œé¢

```bash
python run.py
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:8080` è®¿é—®æ§åˆ¶ç•Œé¢ã€‚

### 5. ä½¿ç”¨Webç•Œé¢

1. **é…ç½®ç™»å½•ä¿¡æ¯** - åœ¨"ç™»å½•é…ç½®"é¢æ¿é…ç½®ç™»å½•URLã€ç”¨æˆ·åå’Œå¯†ç ï¼ˆé‡è¦ï¼ï¼‰
2. **é€‰æ‹©åº”ç”¨æ¨¡å—** - åœ¨å·¦ä¾§å‹¾é€‰è¦æ‰§è¡Œçš„åº”ç”¨æ¨¡å—
3. **é…ç½®é€šçŸ¥** - é…ç½®é’‰é’‰æœºå™¨äººå’Œé‚®ç®±ï¼ˆå¯é€‰ï¼‰
4. **å¼€å§‹æ‰§è¡Œ** - ç‚¹å‡»"å¼€å§‹æ‰§è¡Œ"æŒ‰é’®è¿è¡Œæµ‹è¯•
5. **æŸ¥çœ‹æ—¥å¿—** - å®æ—¶æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—

## ğŸ“ ç¼–å†™æµ‹è¯•ç”¨ä¾‹

### â­ ä½¿ç”¨Playwright Codegenå½•åˆ¶ç”¨ä¾‹ï¼ˆæ¨èç»™å®ä¹ ç”Ÿï¼‰

**è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼å°±åƒå½•å±ä¸€æ ·ï¼Œä½†ç”Ÿæˆçš„æ˜¯ä»£ç ã€‚**

#### å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥æå®šï¼‰

1. **å¯åŠ¨å½•åˆ¶å·¥å…·ï¼ˆå·²è‡ªåŠ¨ç™»å½•ï¼‰**ï¼š
   - **æ¨èæ–¹å¼**ï¼šé€šè¿‡Webç•Œé¢ï¼Œåœ¨"ç”¨ä¾‹å½•åˆ¶"é¢æ¿è¾“å…¥æ¡Œé¢URLï¼ˆå¦‚ `http://10.70.70.96/Shenyuan_9#/index`ï¼‰ï¼Œç‚¹å‡»"å¯åŠ¨å½•åˆ¶"
   - æˆ–è€…ä½¿ç”¨è‡ªåŠ¨ç™»å½•è„šæœ¬ï¼š`python utils/recording_auto_login.py http://10.70.70.96/Shenyuan_9#/index`
   - æµè§ˆå™¨ä¼šè‡ªåŠ¨ç™»å½•å¹¶å…³é—­å¼¹çª—ï¼Œæ‚¨å¯ä»¥ç›´æ¥å¼€å§‹å½•åˆ¶ï¼âœ¨

2. **åœ¨æµè§ˆå™¨ä¸­æ“ä½œ**ï¼š
   - ~~è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ~~ï¼ˆå·²è‡ªåŠ¨å®Œæˆï¼‰
   - ~~ç‚¹å‡»ç™»å½•~~ï¼ˆå·²è‡ªåŠ¨å®Œæˆï¼‰
   - ~~å…³é—­å¼¹çª—~~ï¼ˆå·²è‡ªåŠ¨å®Œæˆï¼‰
   - åŒå‡»åº”ç”¨å›¾æ ‡ï¼ˆå¦‚"æˆè¯¾æ•™å­¦"ï¼‰
   - è¿›è¡Œå„ç§æ“ä½œ...

3. **ä¿å­˜ä»£ç **ï¼š
   - åœæ­¢å½•åˆ¶åï¼Œå¤åˆ¶ç”Ÿæˆçš„ä»£ç 
   - ä¿å­˜åˆ°å¯¹åº”æ–‡ä»¶å¤¹ï¼š
     - æˆè¯¾æ•™å­¦ â†’ `test_cases/teaching/test_xxx.py`
     - æ”»é˜²æ¼”ç»ƒ â†’ `test_cases/exercise/test_xxx.py`
     - è€ƒè¯•æµ‹è¯„ â†’ `test_cases/exam/test_xxx.py`

#### ğŸ“š è¯¦ç»†å½•åˆ¶æŒ‡å—

- **æµ‹è¯•ç”¨ä¾‹ç¼–å†™æŒ‡å—**ï¼šæŸ¥çœ‹ `docs/æµ‹è¯•ç”¨ä¾‹ç¼–å†™æŒ‡å—.md` - è¶…ç®€å•ï¼ŒåŒ…å«å½•åˆ¶å’Œè½¬æ¢è¯´æ˜
- **å½•åˆ¶å·¥å…·ä½¿ç”¨è¯´æ˜**ï¼šæŸ¥çœ‹ `docs/å½•åˆ¶å·¥å…·ä½¿ç”¨è¯´æ˜.md` - å®Œæ•´çš„ä½¿ç”¨è¯´æ˜å’ŒæŠ€å·§

#### å½•åˆ¶ç¤ºä¾‹

```bash
# å½•åˆ¶ç™»å½•é¡µé¢
playwright codegen http://10.70.70.96/Shenyuan_9#/login

# å½•åˆ¶å¹¶ç›´æ¥ä¿å­˜åˆ°æ–‡ä»¶
playwright codegen http://10.70.70.96/Shenyuan_9#/login --target python-async --output test_cases/teaching/test_login.py
```

#### ä¿å­˜ä½ç½®è§„åˆ™

| åº”ç”¨æ¨¡å— | ä¿å­˜ä½ç½® | æ–‡ä»¶å‘½åç¤ºä¾‹ |
|---------|---------|------------|
| æˆè¯¾æ•™å­¦ | `test_cases/teaching/` | `test_teaching_login.py` |
| æ”»é˜²æ¼”ç»ƒ | `test_cases/exercise/` | `test_exercise_start.py` |
| è€ƒè¯•æµ‹è¯„ | `test_cases/exam/` | `test_exam_create.py` |

**è®°ä½**ï¼šæ–‡ä»¶åä»¥ `test_` å¼€å¤´ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿è¿æ¥ï¼

### æ‰‹åŠ¨ç¼–å†™æµ‹è¯•ç”¨ä¾‹

åœ¨ `test_cases/` ç›®å½•ä¸‹åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š

```python
"""
æˆè¯¾æ•™å­¦æµ‹è¯•ç”¨ä¾‹
"""
import pytest
from pages.desktop_page import DesktopPage
from pages.teaching_app import TeachingApp

@pytest.mark.teaching
class TestTeaching:
    """æˆè¯¾æ•™å­¦æµ‹è¯•ç±»"""
    
    @pytest.mark.asyncio
    async def test_open_teaching_app(self, desktop: DesktopPage, driver):
        """æµ‹è¯•æ‰“å¼€æˆè¯¾æ•™å­¦åº”ç”¨"""
        try:
            # ç‚¹å‡»åº”ç”¨å›¾æ ‡
            await desktop.click_app_icon("æˆè¯¾æ•™å­¦")
            
            # åˆ›å»ºåº”ç”¨é¡µé¢å¯¹è±¡
            teaching_app = TeachingApp(driver)
            await teaching_app.wait_for_load()
            
            # éªŒè¯åº”ç”¨å·²æ‰“å¼€
            assert await teaching_app.is_app_opened()
            
        except Exception as e:
            # å¤±è´¥æ—¶è·³è¿‡æ­¥éª¤å¹¶é‡ç½®çŠ¶æ€
            await driver.skip_step(f"æ‰“å¼€åº”ç”¨å¤±è´¥: {e}")
            await driver.reset_to_initial_state()
            raise
```

### è¿è¡Œæµ‹è¯•ç”¨ä¾‹

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæ¨¡å—
pytest -m teaching

# è¿è¡Œå¤šä¸ªæ¨¡å—
pytest -m "teaching or exam"

# è¯¦ç»†è¾“å‡º
pytest -v -s
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### 1. è‡ªåŠ¨ç™»å½•åŠŸèƒ½

æµ‹è¯•æ‰§è¡Œå‰ä¼šè‡ªåŠ¨æ‰§è¡Œç™»å½•æ“ä½œï¼ˆå¦‚æœå¯ç”¨äº† `auto_login`ï¼‰ï¼š
- ç™»å½•URLã€ç”¨æˆ·åã€å¯†ç å¯åœ¨Webæ§åˆ¶ç•Œé¢é…ç½®
- ç™»å½•ä¿¡æ¯ä¿å­˜åœ¨ `config/settings.yaml` ä¸­
- æ”¯æŒè‡ªå®šä¹‰å…ƒç´ é€‰æ‹©å™¨ï¼ˆå¦‚æœé¡µé¢ç»“æ„ç‰¹æ®Šï¼‰

### 2. æ¨¡å—åŒ–åº”ç”¨ç®¡ç†

æ¯ä¸ªåº”ç”¨æ¨¡å—å¯¹åº”ä¸€ä¸ªpytestæ ‡è®°ï¼ˆmarkï¼‰ï¼Œåœ¨ `pytest.ini` ä¸­å®šä¹‰ï¼š

```ini
markers =
    teaching: æˆè¯¾æ•™å­¦æ¨¡å—æµ‹è¯•
    exercise: æ”»é˜²æ¼”ç»ƒæ¨¡å—æµ‹è¯•
    exam: è€ƒè¯•æµ‹è¯„æ¨¡å—æµ‹è¯•
```

### 3. æ•°æ®åº“æ“ä½œ

```python
from core.db_client import DBClient

# æ–¹å¼1ï¼šä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼ˆæ¨èï¼‰
with DBClient() as db:
    # æŸ¥è¯¢æ•°æ®
    results = db.execute_query("SELECT * FROM users WHERE id = %s", (1,))
    for row in results:
        print(row)
    
    # æ›´æ–°æ•°æ®
    db.execute_update("UPDATE users SET name = %s WHERE id = %s", ("æ–°åç§°", 1))

# æ–¹å¼2ï¼šæ‰‹åŠ¨ç®¡ç†è¿æ¥
db = DBClient()
db.connect()
try:
    results = db.execute_query("SELECT * FROM users")
    db.execute_update("INSERT INTO users (name, email) VALUES (%s, %s)", ("å¼ ä¸‰", "zhangsan@example.com"))
finally:
    db.disconnect()

# æ–¹å¼3ï¼šä½¿ç”¨è¿æ¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨
db = DBClient()
with db.get_connection() as conn:
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM users")
    results = cursor.fetchall()
```

**SSHéš§é“æ”¯æŒ**ï¼š
å¦‚æœæ•°æ®åº“éœ€è¦é€šè¿‡SSHéš§é“è®¿é—®ï¼Œåœ¨ `config/settings.yaml` ä¸­é…ç½®ï¼š
```yaml
database:
  host: 10.70.70.96
  port: 3306
  user: root
  password: your_password
  database: test_db
  ssh_tunnel:
    enabled: true
    ssh_host: 10.70.70.96
    ssh_port: 22
    ssh_user: user
    ssh_password: your_ssh_password
    # æˆ–è€…ä½¿ç”¨å¯†é’¥æ–‡ä»¶
    # ssh_private_key: /path/to/private_key
```

### 4. é€šçŸ¥æœåŠ¡

```python
from core.notification import NotificationService

notification = NotificationService()

# å‘é€é’‰é’‰æ¶ˆæ¯
notification.send_dingtalk_message("æµ‹è¯•å®Œæˆ", "æµ‹è¯•é€šçŸ¥")

# å‘é€é‚®ä»¶
notification.send_email("æµ‹è¯•æŠ¥å‘Š", "æµ‹è¯•å†…å®¹")

# å‘é€æµ‹è¯•æŠ¥å‘Š
notification.send_test_report(
    modules=["teaching", "exam"],
    total=10,
    passed=8,
    failed=2,
    skipped=0,
    duration=120.5
)
```

### 5. å¤±è´¥å¤„ç†æœºåˆ¶

æµ‹è¯•ç”¨ä¾‹ä¸­å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å¤„ç†å¤±è´¥ï¼š

```python
# è·³è¿‡å½“å‰æ­¥éª¤
await driver.skip_step("æ­¥éª¤è·³è¿‡åŸå› ")

# é‡ç½®åˆ°åˆå§‹çŠ¶æ€
await driver.reset_to_initial_state()
```

### 6. Page Objectæ¨¡å¼

æ¯ä¸ªåº”ç”¨é¡µé¢éƒ½å°è£…ä¸ºç‹¬ç«‹çš„Page Objectç±»ï¼Œä¾‹å¦‚ï¼š

```python
class TeachingApp(BasePage):
    async def start_teaching(self):
        """å¼€å§‹æˆè¯¾"""
        await self.driver.click('button:has-text("å¼€å§‹æˆè¯¾")')
    
    async def select_course(self, course_name: str):
        """é€‰æ‹©è¯¾ç¨‹"""
        await self.driver.click(f'[data-course="{course_name}"]')
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **ä½¿ç”¨Page Objectæ¨¡å¼** - å°†é¡µé¢æ“ä½œå°è£…åœ¨Pageç±»ä¸­ï¼Œæµ‹è¯•ç”¨ä¾‹åªå…³æ³¨ä¸šåŠ¡é€»è¾‘
2. **åˆç†ä½¿ç”¨ç­‰å¾…** - ä½¿ç”¨Playwrightçš„è‡ªåŠ¨ç­‰å¾…æœºåˆ¶ï¼Œé¿å…ç¡¬ç¼–ç sleep
3. **é”™è¯¯å¤„ç†** - åœ¨å…³é”®æ­¥éª¤ä½¿ç”¨try-exceptï¼Œæ”¯æŒè·³è¿‡å’Œé‡ç½®
4. **æ¨¡å—åŒ–è®¾è®¡** - æ¯ä¸ªåº”ç”¨æ¨¡å—ç‹¬ç«‹ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
5. **å½•åˆ¶+é‡æ„** - ä½¿ç”¨Codegenå½•åˆ¶åŸºç¡€æ“ä½œï¼Œç„¶åé‡æ„ä¸ºPage Objectæ¨¡å¼

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

é¡¹ç›®æ”¯æŒå¤šç§æµ‹è¯•æŠ¥å‘Šæ ¼å¼ï¼š

- **pytest-html**: è‡ªåŠ¨ç”ŸæˆHTMLæŠ¥å‘Šï¼ŒTeståˆ—æ˜¾ç¤ºä¸­æ–‡æ¨¡å—å’Œç±»ä¿¡æ¯
  - æŠ¥å‘Šä½ç½®ï¼š`reports/pytestè‡ªåŠ¨åŒ–æµ‹è¯•æŠ¥å‘Š_YYYYMMDD_HHMMSS.html`
  - æ”¯æŒå¤±è´¥é‡è¯•æ˜¾ç¤ºï¼Œæ¯ä¸ªçŠ¶æ€ï¼ˆrerunã€passedã€failedï¼‰å•ç‹¬æ˜¾ç¤º

- **è‡ªå®šä¹‰ä¸­æ–‡æŠ¥å‘Š**: ç”Ÿæˆç¾è§‚çš„ä¸­æ–‡æµ‹è¯•æŠ¥å‘Šï¼ˆæ¨èï¼‰
  - æŠ¥å‘Šä½ç½®ï¼š`reports/WebUIè‡ªåŠ¨åŒ–æµ‹è¯•æŠ¥å‘Š_YYYYMMDD_HHMMSS.html`
  - åŒ…å«ï¼šæµ‹è¯•ç»“æœç»Ÿè®¡ã€æ‰§è¡Œæ—¶é•¿å¯¹æ¯”ã€æ¨¡å—é€šè¿‡ç‡çƒ­åŠ›å›¾ã€é€šè¿‡ç‡è¶‹åŠ¿åˆ†æ
  - æ”¯æŒå›¾è¡¨å±•ç¤ºï¼Œä¾¿äºåˆ†ææµ‹è¯•è¶‹åŠ¿

- **Allure**: ç”ŸæˆAllureæŠ¥å‘Šï¼ˆéœ€å®‰è£…allure-pytestï¼‰
  ```bash
  pytest --alluredir=allure-results
  allure serve allure-results
  ```

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ `docs/æµ‹è¯•æŠ¥å‘Šè¯´æ˜.md`

## ğŸ” å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å®šä½"Webæ¡Œé¢"ä¸­çš„åŠ¨æ€å…ƒç´ ï¼Ÿ

A: ä¼˜å…ˆä½¿ç”¨Playwrightçš„è¯­ä¹‰åŒ–å®šä½æ–¹å¼ï¼š
- `page.get_by_role()` - é€šè¿‡è§’è‰²å®šä½
- `page.get_by_text()` - é€šè¿‡æ–‡æœ¬å®šä½
- `page.get_by_label()` - é€šè¿‡æ ‡ç­¾å®šä½

é¿å…ä½¿ç”¨ä¸ç¨³å®šçš„CSSé€‰æ‹©å™¨ã€‚

### Q: å¦‚ä½•å¤„ç†å¼¹çª—åº”ç”¨ï¼Ÿ

A: ä½¿ç”¨Page Objectæ¨¡å¼ï¼Œä¸ºæ¯ä¸ªåº”ç”¨åˆ›å»ºç‹¬ç«‹çš„Pageç±»ï¼Œå°è£…åº”ç”¨å†…çš„æ“ä½œã€‚

### Q: æµ‹è¯•ç”¨ä¾‹å¡ä½æ€ä¹ˆåŠï¼Ÿ

A: ä½¿ç”¨ `driver.skip_step()` è·³è¿‡å½“å‰æ­¥éª¤ï¼Œæˆ–ä½¿ç”¨ `driver.reset_to_initial_state()` é‡ç½®çŠ¶æ€ã€‚

### Q: å¦‚ä½•æ·»åŠ æ–°çš„åº”ç”¨æ¨¡å—ï¼Ÿ

è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒ `docs/æ–°å¢æ¨¡å—æŒ‡å—.md`ï¼ŒåŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š

1. **åœ¨ `config/module_config.yaml` ä¸­æ·»åŠ æ¨¡å—é…ç½®**
   ```yaml
   modules:
     your_module:
       name: ä½ çš„æ¨¡å—åç§°
       description: æ¨¡å—æè¿°
       enabled: true
       mark: your_module
   ```

2. **åœ¨ `pytest.ini` ä¸­æ·»åŠ æ¨¡å—æ ‡è®°**
   ```ini
   markers =
       your_module: ä½ çš„æ¨¡å—åç§°æµ‹è¯•
   ```

3. **åœ¨ `test_cases/` ç›®å½•ä¸‹åˆ›å»ºæµ‹è¯•ç”¨ä¾‹ç›®å½•**
   ```bash
   mkdir test_cases/your_module
   ```

4. **åˆ›å»ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶**ï¼ˆå‚è€ƒ `docs/æµ‹è¯•ç”¨ä¾‹ç¼–å†™æŒ‡å—.md`ï¼‰

5. **ï¼ˆå¯é€‰ï¼‰åœ¨ `pages/` ç›®å½•ä¸‹åˆ›å»ºåº”ç”¨é¡µé¢ç±»**ï¼ˆå¦‚æœä½¿ç”¨Page Objectæ¨¡å¼ï¼‰

## ğŸ“Š Excelç”¨ä¾‹å¯¼å…¥ï¼ˆæ–°åŠŸèƒ½ï¼‰

æ”¯æŒä»Excelè¡¨æ ¼å¯¼å…¥æµ‹è¯•ç”¨ä¾‹ï¼Œè®©éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼

### å¿«é€Ÿå¼€å§‹

1. **åˆ›å»ºExcelæ¨¡æ¿**ï¼š
   ```bash
   python utils/excel_importer.py template
   ```

2. **å¡«å†™æµ‹è¯•ç”¨ä¾‹**ï¼ˆåœ¨Excelä¸­ï¼‰ï¼š
   - æ¨¡å—åç§°ã€ç”¨ä¾‹åç§°ã€æ“ä½œæ­¥éª¤ç­‰

3. **å¯¼å…¥å¹¶ç”Ÿæˆä»£ç **ï¼š
   ```bash
   python utils/excel_importer.py import test_cases.xlsx
   ```

### è¯¦ç»†è¯´æ˜

æŸ¥çœ‹ `docs/` ç›®å½•ä¸‹çš„ç›¸å…³æ–‡æ¡£äº†è§£å®Œæ•´çš„ä½¿ç”¨æ–¹æ³•å’Œç¤ºä¾‹ã€‚

### ä¼˜åŠ¿

- âœ… **é™ä½é—¨æ§›**ï¼šéæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½ç¼–å†™ç”¨ä¾‹
- âœ… **æ‰¹é‡åˆ›å»º**ï¼šå¿«é€Ÿåˆ›å»ºå¤§é‡æµ‹è¯•ç”¨ä¾‹
- âœ… **æ˜“äºç»´æŠ¤**ï¼šä¿®æ”¹Excelæ¯”ä¿®æ”¹ä»£ç ç®€å•
- âœ… **ç‰ˆæœ¬ç®¡ç†**ï¼šExcelæ–‡ä»¶å¯ä»¥çº³å…¥Gitç®¡ç†

## ğŸ“š æ›´å¤šèµ„æº

### å¤–éƒ¨æ–‡æ¡£

- [Playwrightæ–‡æ¡£](https://playwright.dev/python/)
- [pytestæ–‡æ¡£](https://docs.pytest.org/)
- [NiceGUIæ–‡æ¡£](https://nicegui.io/)
- [PyMySQLæ–‡æ¡£](https://pymysql.readthedocs.io/)

### é¡¹ç›®æ–‡æ¡£

æ‰€æœ‰è¯¦ç»†æ–‡æ¡£éƒ½åœ¨ `docs/` ç›®å½•ä¸‹ï¼š

- **æµ‹è¯•ç”¨ä¾‹ç¼–å†™æŒ‡å—** - `docs/æµ‹è¯•ç”¨ä¾‹ç¼–å†™æŒ‡å—.md` - å¦‚ä½•ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼ˆæ¨èç»™å®ä¹ ç”Ÿï¼‰
- **æ–°å¢æ¨¡å—æŒ‡å—** - `docs/æ–°å¢æ¨¡å—æŒ‡å—.md` - å¦‚ä½•æ·»åŠ æ–°çš„åº”ç”¨æ¨¡å—
- **Webç•Œé¢ä½¿ç”¨è¯´æ˜** - `docs/Webç•Œé¢ä½¿ç”¨è¯´æ˜.md` - Webæ§åˆ¶ç•Œé¢è¯¦ç»†ä½¿ç”¨è¯´æ˜
- **æµ‹è¯•æŠ¥å‘Šè¯´æ˜** - `docs/æµ‹è¯•æŠ¥å‘Šè¯´æ˜.md` - æµ‹è¯•æŠ¥å‘ŠåŠŸèƒ½è¯´æ˜
- **é«˜çº§åŠŸèƒ½è¯´æ˜** - `docs/é«˜çº§åŠŸèƒ½è¯´æ˜.md` - é«˜çº§åŠŸèƒ½ä½¿ç”¨è¯´æ˜
- **å½•åˆ¶å·¥å…·ä½¿ç”¨è¯´æ˜** - `docs/å½•åˆ¶å·¥å…·ä½¿ç”¨è¯´æ˜.md` - ç”¨ä¾‹å½•åˆ¶å·¥å…·ä½¿ç”¨è¯´æ˜
- **ä»£ç è½¬æ¢å·¥å…·ä½¿ç”¨è¯´æ˜** - `docs/ä»£ç è½¬æ¢å·¥å…·ä½¿ç”¨è¯´æ˜.md` - ä»£ç è½¬æ¢å·¥å…·ä½¿ç”¨è¯´æ˜
- **é¡µé¢å¯¹è±¡è¯´æ˜** - `docs/é¡µé¢å¯¹è±¡è¯´æ˜.md` - Page Objectæ¨¡å¼è¯´æ˜
- **å…¶ä»–æ–‡æ¡£** - æŸ¥çœ‹ `docs/` ç›®å½•è·å–æ›´å¤šæ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ‘¥ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œè¯·æ ¹æ®å®é™…Webåº”ç”¨çš„å‰ç«¯æŠ€æœ¯æ ˆè°ƒæ•´å…ƒç´ å®šä½ç­–ç•¥ã€‚


