# æ–°å¢æ¨¡å—æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•åœ¨é¡¹ç›®ä¸­æ·»åŠ æ–°çš„åº”ç”¨æ¨¡å—ã€‚

## ğŸ“‹ æ¦‚è¿°

æ·»åŠ æ–°æ¨¡å—éœ€è¦å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. åœ¨ `config/module_config.yaml` ä¸­æ·»åŠ æ¨¡å—é…ç½®
2. åœ¨ `pytest.ini` ä¸­æ·»åŠ æ¨¡å—æ ‡è®°
3. åœ¨ `test_cases/` ç›®å½•ä¸‹åˆ›å»ºæµ‹è¯•ç”¨ä¾‹ç›®å½•
4. åˆ›å»ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶
5. ï¼ˆå¯é€‰ï¼‰åœ¨ `pages/` ç›®å½•ä¸‹åˆ›å»ºåº”ç”¨é¡µé¢ç±»

## ğŸ”§ è¯¦ç»†æ­¥éª¤

### æ­¥éª¤1: æ·»åŠ æ¨¡å—é…ç½®

ç¼–è¾‘ `config/module_config.yaml` æ–‡ä»¶ï¼Œåœ¨ `modules` éƒ¨åˆ†æ·»åŠ æ–°æ¨¡å—ï¼š

```yaml
modules:
  # ç°æœ‰æ¨¡å—...
  teaching:
    name: æˆè¯¾æ•™å­¦
    description: æˆè¯¾æ•™å­¦åº”ç”¨æ¨¡å—
    enabled: true
    mark: teaching
  
  # æ–°å¢æ¨¡å—
  your_module:
    name: ä½ çš„æ¨¡å—åç§°
    description: æ¨¡å—æè¿°ä¿¡æ¯
    enabled: true
    mark: your_module
    icon: ''  # å›¾æ ‡URLï¼Œå¯é€‰
```

**é…ç½®è¯´æ˜**ï¼š
- `your_module`: æ¨¡å—çš„keyï¼ˆä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼‰
- `name`: æ¨¡å—çš„ä¸­æ–‡æ˜¾ç¤ºåç§°
- `description`: æ¨¡å—æè¿°
- `enabled`: æ˜¯å¦å¯ç”¨ï¼ˆtrue/falseï¼‰
- `mark`: pytestæ ‡è®°åç§°ï¼ˆé€šå¸¸ä¸keyç›¸åŒï¼‰
- `icon`: å›¾æ ‡è·¯å¾„ï¼ˆå¯é€‰ï¼‰ï¼Œæ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š
  - Webè·¯å¾„ï¼š`/assets/images/your-icon.png`ï¼ˆæ¨èï¼‰
  - ç›¸å¯¹è·¯å¾„ï¼š`assets/images/your-icon.png`
  - æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ï¼š`assets/images/your-icon.png`ï¼ˆä¼šè‡ªåŠ¨è½¬æ¢ä¸ºWebè·¯å¾„ï¼‰
  
  å›¾æ ‡æ–‡ä»¶åº”æ”¾åœ¨ `assets/images/` ç›®å½•ä¸‹ã€‚

### æ­¥éª¤2: æ·»åŠ pytestæ ‡è®°

ç¼–è¾‘ `pytest.ini` æ–‡ä»¶ï¼Œåœ¨ `markers` éƒ¨åˆ†æ·»åŠ æ–°æ¨¡å—æ ‡è®°ï¼š

```ini
[pytest]
markers =
    teaching: æˆè¯¾æ•™å­¦æ¨¡å—æµ‹è¯•
    exercise: æ”»é˜²æ¼”ç»ƒæ¨¡å—æµ‹è¯•
    exam: è€ƒè¯•æµ‹è¯„æ¨¡å—æµ‹è¯•
    your_module: ä½ çš„æ¨¡å—åç§°æµ‹è¯•
```

### æ­¥éª¤3: åˆ›å»ºæµ‹è¯•ç”¨ä¾‹ç›®å½•

åœ¨ `test_cases/` ç›®å½•ä¸‹åˆ›å»ºæ–°æ¨¡å—çš„ç›®å½•ï¼š

```bash
mkdir test_cases/your_module
```

### æ­¥éª¤4: åˆ›å»ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶

åœ¨ `test_cases/your_module/` ç›®å½•ä¸‹åˆ›å»ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶ï¼Œå‚è€ƒä»¥ä¸‹æ¨¡æ¿ï¼š

```python
"""
ä½ çš„æ¨¡å—åç§°æµ‹è¯•ç”¨ä¾‹
"""
import pytest
from pages.desktop_page import DesktopPage
from core.web_ui_driver import WebUIDriver

@pytest.mark.your_module
class TestYourModule:
    """ä½ çš„æ¨¡å—åç§°æµ‹è¯•ç±»"""
    
    @pytest.mark.asyncio
    async def test_your_module_function(self, desktop: DesktopPage, driver: WebUIDriver):
        """æµ‹è¯•ä½ çš„æ¨¡å—åŠŸèƒ½"""
        try:
            # ç‚¹å‡»åº”ç”¨å›¾æ ‡
            await desktop.click_app_icon("ä½ çš„æ¨¡å—åç§°")
            
            # ç­‰å¾…åº”ç”¨åŠ è½½
            page = driver.page
            await page.wait_for_timeout(2000)
            
            # æ‰§è¡Œæµ‹è¯•æ“ä½œ
            # ...
            
        except Exception as e:
            # å¤±è´¥æ—¶è·³è¿‡æ­¥éª¤å¹¶é‡ç½®çŠ¶æ€
            await driver.skip_step(f"æµ‹è¯•å¤±è´¥: {e}")
            await driver.reset_to_initial_state()
            raise
```

**æ–‡ä»¶å‘½åè§„åˆ™**ï¼š
- æ–‡ä»¶åä»¥ `test_` å¼€å¤´
- ä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿
- ä¾‹å¦‚ï¼š`test_your_module_basic.py`

### æ­¥éª¤5: ï¼ˆå¯é€‰ï¼‰åˆ›å»ºé¡µé¢å¯¹è±¡ç±»

å¦‚æœä½¿ç”¨Page Objectæ¨¡å¼ï¼Œåœ¨ `pages/` ç›®å½•ä¸‹åˆ›å»ºåº”ç”¨é¡µé¢ç±»ï¼š

```python
"""
ä½ çš„æ¨¡å—åº”ç”¨é¡µé¢å¯¹è±¡
"""
from pages.base_page import BasePage
from core.web_ui_driver import WebUIDriver

class YourModuleApp(BasePage):
    """ä½ çš„æ¨¡å—åº”ç”¨é¡µé¢ç±»"""
    
    def __init__(self, driver: WebUIDriver):
        super().__init__(driver)
        self.app_name = "ä½ çš„æ¨¡å—åç§°"
    
    async def wait_for_load(self):
        """ç­‰å¾…åº”ç”¨åŠ è½½å®Œæˆ"""
        # å®ç°ç­‰å¾…é€»è¾‘
        await self.driver.page.wait_for_timeout(2000)
    
    async def your_module_action(self):
        """ä½ çš„æ¨¡å—æ“ä½œ"""
        # å®ç°å…·ä½“æ“ä½œ
        pass
```

## âœ… éªŒè¯

å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼ŒéªŒè¯æ–°æ¨¡å—æ˜¯å¦æ·»åŠ æˆåŠŸï¼š

1. **å¯åŠ¨Webæ§åˆ¶ç•Œé¢**
   ```bash
   python run.py
   ```

2. **æ£€æŸ¥æ¨¡å—é€‰æ‹©å™¨**
   - åœ¨Webç•Œé¢å·¦ä¾§çš„"æ¨¡å—é€‰æ‹©"é¢æ¿ä¸­ï¼Œåº”è¯¥èƒ½çœ‹åˆ°æ–°æ·»åŠ çš„æ¨¡å—
   - å‹¾é€‰æ–°æ¨¡å—ï¼Œç‚¹å‡»"å¼€å§‹æ‰§è¡Œ"æµ‹è¯•

3. **è¿è¡Œæµ‹è¯•**
   ```bash
   # è¿è¡Œæ–°æ¨¡å—çš„æ‰€æœ‰æµ‹è¯•
   pytest -m your_module
   
   # è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
   pytest test_cases/your_module/test_your_module_basic.py -v
   ```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ¨¡å—keyå‘½å**ï¼š
   - ä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿
   - é¿å…ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦
   - ä¿æŒç®€æ´å’Œæœ‰æ„ä¹‰

2. **pytestæ ‡è®°**ï¼š
   - æ ‡è®°åç§°é€šå¸¸ä¸æ¨¡å—keyç›¸åŒ
   - ç¡®ä¿åœ¨ `pytest.ini` ä¸­æ­£ç¡®é…ç½®

3. **æµ‹è¯•ç”¨ä¾‹ç»„ç»‡**ï¼š
   - æ¯ä¸ªæ¨¡å—æœ‰ç‹¬ç«‹çš„ç›®å½•
   - æµ‹è¯•æ–‡ä»¶æ”¾åœ¨å¯¹åº”æ¨¡å—ç›®å½•ä¸‹
   - ä½¿ç”¨æ¸…æ™°çš„å‘½åè§„èŒƒ

4. **æ¨¡å—é…ç½®**ï¼š
   - `enabled: true` è¡¨ç¤ºæ¨¡å—å¯ç”¨ï¼Œå¯ä»¥åœ¨Webç•Œé¢ä¸­é€‰æ‹©
   - `enabled: false` è¡¨ç¤ºæ¨¡å—ç¦ç”¨ï¼Œä¸ä¼šåœ¨Webç•Œé¢ä¸­æ˜¾ç¤º

## ğŸ” ç¤ºä¾‹

å‡è®¾è¦æ·»åŠ ä¸€ä¸ªåä¸º"æ•°æ®åˆ†æ"çš„æ¨¡å—ï¼š

1. **æ¨¡å—é…ç½®** (`config/module_config.yaml`):
   ```yaml
   modules:
     data_analysis:
       name: æ•°æ®åˆ†æ
       description: æ•°æ®åˆ†æåº”ç”¨æ¨¡å—
       enabled: true
       mark: data_analysis
   ```

2. **pytestæ ‡è®°** (`pytest.ini`):
   ```ini
   markers =
       data_analysis: æ•°æ®åˆ†ææ¨¡å—æµ‹è¯•
   ```

3. **æµ‹è¯•ç”¨ä¾‹ç›®å½•**:
   ```bash
   mkdir test_cases/data_analysis
   ```

4. **æµ‹è¯•ç”¨ä¾‹æ–‡ä»¶** (`test_cases/data_analysis/test_data_analysis_basic.py`):
   ```python
   @pytest.mark.data_analysis
   class TestDataAnalysis:
       """æ•°æ®åˆ†ææµ‹è¯•ç±»"""
       # ...
   ```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **æµ‹è¯•ç”¨ä¾‹ç¼–å†™æŒ‡å—**: `docs/æµ‹è¯•ç”¨ä¾‹ç¼–å†™æŒ‡å—.md`
- **é¡µé¢å¯¹è±¡è¯´æ˜**: `docs/é¡µé¢å¯¹è±¡è¯´æ˜.md`
- **Webç•Œé¢ä½¿ç”¨è¯´æ˜**: `docs/Webç•Œé¢ä½¿ç”¨è¯´æ˜.md`

---

**æç¤º**: æ·»åŠ æ–°æ¨¡å—åï¼Œå»ºè®®å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹éªŒè¯æ¨¡å—é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œç„¶åå†æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹ã€‚

