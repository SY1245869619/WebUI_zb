# Web控制界面使用说明

## 📖 简介

Web控制界面是基于NiceGUI开发的图形化测试管理平台，提供可视化的测试配置、执行和监控功能。

## 🚀 启动界面

### 启动命令

```bash
python run.py
```

### 访问地址

启动后，在浏览器中访问：

```
http://localhost:8080
```

## 🎨 界面布局

### 顶部Banner

- **标题**: WebUI自动化测试控制台
- **公司信息**: 北京丈八网安网络科技有限公司
- **全屏按钮**: 右上角可以切换全屏模式

### 左侧配置区域（40%宽度）

包含以下配置面板：

1. **登录配置** - 配置登录URL、用户名、密码
2. **模块选择** - 选择要执行的应用模块
3. **通知配置** - 配置钉钉和邮件通知

### 右侧执行区域（60%宽度）

包含以下功能面板：

1. **执行控制** - 开始/停止测试执行
2. **执行日志** - 实时查看测试执行日志
3. **用例录制** - 录制测试用例和代码转换

## 📋 功能说明

### 1. 登录配置

**位置**: 左侧第一个面板

**功能**:
- 配置登录页面URL
- 配置用户名和密码
- 配置自动登录开关
- 高级选项：自定义元素选择器

**使用步骤**:
1. 输入登录URL（例如：`http://10.70.70.96/Shenyuan_9#/login`）
2. 输入用户名和密码
3. 勾选"自动登录"（推荐）
4. 点击"保存登录配置"

**注意事项**:
- 配置会自动保存到 `config/settings.yaml`
- 如果页面元素特殊，可以在"高级选项"中自定义选择器

### 2. 模块选择

**位置**: 左侧第二个面板

**功能**:
- 选择要执行的应用模块
- 支持全选/取消全选
- 默认全选所有模块

**可用模块**:
- ✅ **授课教学** - 教学管理、课程库、排课等
- ✅ **攻防演练** - 攻防演练相关功能
- ✅ **考试测评** - 考试、测评相关功能

**使用步骤**:
1. 勾选要执行的模块（可以多选）
2. 系统会自动生成对应的pytest标记

### 3. 通知配置

**位置**: 左侧第三个面板

**功能**:
- 配置钉钉机器人通知
- 配置邮件通知
- 测试完成后自动发送报告

**钉钉通知配置**:
1. 勾选"启用钉钉通知"
2. 输入Webhook地址
3. 输入Secret（可选）
4. 点击"保存通知配置"

**邮件通知配置**:
1. 勾选"启用邮件通知"
2. 配置SMTP服务器和端口
3. 输入发件人邮箱和密码/授权码
4. 输入收件人邮箱（多个用换行分隔）
5. 点击"保存通知配置"

### 4. 执行控制

**位置**: 右侧第一个面板

**功能**:
- 开始执行测试
- 停止执行测试
- 查看执行状态
- 查看执行进度

**使用步骤**:
1. 确保已配置登录信息和选择模块
2. 选择执行选项（无头模式、详细输出）
3. 点击"开始执行"按钮
4. 实时查看执行状态和进度
5. 如需停止，点击"停止执行"按钮

**执行选项**:
- **无头模式**: 浏览器在后台运行（不显示窗口）
- **详细输出**: 显示详细的测试输出信息

### 5. 执行日志

**位置**: 右侧第二个面板

**功能**:
- 实时显示测试执行日志
- 清空日志
- 导出日志到文件

**日志内容**:
- 测试执行开始/结束时间
- 测试用例执行结果
- 错误信息和堆栈跟踪
- pytest输出信息

**使用步骤**:
1. 执行测试时自动显示日志
2. 点击"清空日志"清除当前日志
3. 点击"导出日志"保存日志到文件

### 6. 用例录制

**位置**: 右侧第三个面板

**功能**:
- 启动Playwright录制工具
- 代码转换工具
- 教程视频播放

**启动录制**:
1. 输入目标URL（默认使用登录URL）
2. 点击"启动录制"按钮
3. 在打开的浏览器中操作
4. 录制工具会自动生成代码

**代码转换**:
1. 点击"代码转换"按钮
2. 选择模块（动态显示所有启用的模块）和输入测试名称
3. 粘贴录制的代码（输入框会根据内容自动调整大小）
4. 点击"转换"按钮查看转换结果（在弹窗中显示）
5. 确认转换结果无误后，点击"保存"按钮保存到对应目录

**注意**：
- 代码输入框会自动根据粘贴内容调整大小，方便查看完整代码
- "保存"按钮在转换完成前是禁用状态，只有转换成功后才会启用
- 转换结果会在弹窗中显示，方便查看和确认

**教程视频**:
1. 点击"教程视频"按钮
2. 观看录制教程视频（如果已上传）

## 🎯 使用流程

### 完整测试流程

1. **配置登录信息**
   - 在"登录配置"面板输入URL、用户名、密码
   - 点击"保存登录配置"

2. **选择测试模块**
   - 在"模块选择"面板勾选要测试的模块
   - 可以多选

3. **配置通知（可选）**
   - 如果需要，配置钉钉或邮件通知

4. **开始执行**
   - 在"执行控制"面板点击"开始执行"
   - 实时查看"执行日志"

5. **查看结果**
   - 在日志中查看测试结果
   - 如果配置了通知，会收到测试报告

### 录制用例流程

1. **启动录制**
   - 在"用例录制"面板输入URL
   - 点击"启动录制"

2. **执行操作**
   - 在浏览器中正常操作
   - 录制工具自动记录

3. **转换代码**
   - 复制录制的代码
   - 使用"代码转换"工具转换
   - 保存到对应目录

## ⚠️ 注意事项

1. **首次使用**
   - 必须先配置登录信息
   - 确保登录URL、用户名、密码正确

2. **模块选择**
   - 至少选择一个模块才能执行
   - 可以同时选择多个模块

3. **执行测试**
   - 执行过程中不要关闭浏览器
   - 可以通过"停止执行"按钮停止

4. **日志查看**
   - 日志会自动滚动到最新
   - 日志过多时建议清空或导出

5. **代码转换**
   - 确保粘贴完整的录制代码
   - 测试名称使用小写字母和下划线

## 🔧 常见问题

### Q1: 界面无法访问？

**A:** 检查以下几点：
- 确保已运行 `python run.py`
- 检查端口8080是否被占用
- 尝试使用 `http://127.0.0.1:8080`

### Q2: 登录配置保存失败？

**A:** 检查以下几点：
- 确保 `config/settings.yaml` 文件存在
- 检查文件权限
- 查看浏览器控制台错误信息

### Q3: 测试执行失败？

**A:** 检查以下几点：
- 确保登录配置正确
- 检查网络连接
- 查看执行日志中的错误信息

### Q4: 代码转换失败？

**A:** 检查以下几点：
- 确保粘贴的是完整的录制代码
- 检查测试名称格式
- 查看转换结果中的错误信息

## 📚 相关资源

- **项目主文档**: `../README.md`
- **测试用例编写指南**: `测试用例编写指南.md`
- **代码转换说明**: `代码转换工具使用说明.md`
- **新增模块指南**: `新增模块指南.md`
- **录制工具使用说明**: `录制工具使用说明.md`

---

**提示**: Web控制界面提供了完整的测试管理功能，建议优先使用Web界面进行操作！

